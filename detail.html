<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>틈새 - 상세 지도</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Leaflet CSS & JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&family=Noto+Serif+KR:wght@200..900&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'giwa-charcoal': '#2C2C2C',
                        'hanji-white': '#F4F4F0',
                        'pine-green': '#2E4C38',
                    },
                    fontFamily: {
                        serif: ['"Noto Serif KR"', 'serif'],
                        sans: ['"Noto Sans KR"', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        body,
        html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }

        #map {
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        .leaflet-container {
            background: #2C2C2C;
        }

        /* Dark Theme for Map Tiles (CSS Filter Hack) */
        .leaflet-tile {
            filter: grayscale(100%) invert(90%) hue-rotate(180deg) brightness(80%) contrast(120%);
        }
    </style>
</head>

<body class="relative">

    <!-- Navigation Overlay -->
    <nav
        class="absolute top-0 left-0 w-full z-50 p-6 flex justify-between items-center bg-gradient-to-b from-giwa-charcoal/80 to-transparent pointer-events-none">
        <a href="index.html"
            class="pointer-events-auto text-xl font-serif font-bold text-hanji-white hover:text-pine-green transition-colors flex items-center gap-2 drop-shadow-md">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="m15 18-6-6 6-6" />
            </svg>
            돌아가기
        </a>
        <div class="text-hanji-white font-serif font-bold text-2xl drop-shadow-md" id="district-title">서울</div>
    </nav>

    <!-- Fullscreen Map Container -->
    <div id="map"></div>

    <!-- Info Panel Overlay (Bottom) -->
    <div
        class="absolute bottom-8 left-1/2 -translate-x-1/2 z-50 w-[90%] max-w-md bg-giwa-charcoal/90 text-hanji-white p-6 rounded-lg backdrop-blur-sm border border-hanji-white/10 shadow-2xl">
        <h3 class="text-xl font-serif font-bold mb-2">틈새 스팟 탐색</h3>
        <p class="text-sm font-sans text-gray-300" id="map-desc">
            지도를 드래그하여 주변의 조용한 장소를 찾아보세요.
        </p>
    </div>

    <script>
        // District Coordinates (Approximate)
        const districts = {
            'Jongno': { name: '종로구', lat: 37.5830, lng: 126.9794, desc: '시간이 멈춘 듯한 고궁과 골목.' },
            'Jung': { name: '중구', lat: 37.5636, lng: 126.9975, desc: '빌딩 숲 사이 숨겨진 근대 건축물.' },
            'Yongsan': { name: '용산구', lat: 37.5323, lng: 126.9907, desc: '이국의 정취와 남산의 고요함.' },
            'Mapo': { name: '마포구', lat: 37.5662, lng: 126.9016, desc: '한강의 물결과 예술적인 영감.' },
            'Seodaemun': { name: '서대문구', lat: 37.5794, lng: 126.9366, desc: '숲길과 역사가 만나는 산책로.' },
            'Gangnam': { name: '강남구', lat: 37.5177, lng: 127.0473, desc: '도심 속 비밀 정원과 선정릉.' },
            'Seocho': { name: '서초구', lat: 37.4836, lng: 127.0327, desc: '예술의 전당 너머 우면산 자락.' },
            'Seongdong': { name: '성동구', lat: 37.5635, lng: 127.0368, desc: '붉은 벽돌과 서울숲의 사색.' },
            'Songpa': { name: '송파구', lat: 37.5144, lng: 127.1059, desc: '석촌호수의 윤슬과 백제 고분.' },
        };

        // URL Params
        const urlParams = new URLSearchParams(window.location.search);
        const districtKey = urlParams.get('district') || 'Jongno'; // Default to Jongno
        const currentDistrict = districts[districtKey] || districts['Jongno'];

        // Update UI
        document.getElementById('district-title').textContent = currentDistrict.name;
        document.getElementById('map-desc').textContent = currentDistrict.desc;

        // Initialize Map
        // Using 'CartoDB Positron' tiles but inverted via CSS for dark mode
        const map = L.map('map', {
            center: [currentDistrict.lat, currentDistrict.lng],
            zoom: 14,
            zoomControl: false
        });

        // Add Tile Layer (OpenStreetMap based)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19
        }).addTo(map);

        // Custom Icon for 'Teumsae' Spots
        const giwaIcon = L.divIcon({
            className: 'custom-div-icon',
            html: `
                <div style="background-color: #2E4C38; width: 16px; height: 16px; border-radius: 50%; border: 2px solid #F4F4F0; box-shadow: 0 0 10px #2E4C38;"></div>
                <div style="width: 16px; height: 16px; background: #2E4C38; opacity: 0.3; border-radius: 50%; animation: ping 1.5s cubic-bezier(0, 0, 0.2, 1) infinite; position: absolute; top: 0; left: 0;"></div>
            `,
            iconSize: [24, 24],
            iconAnchor: [12, 12]
        });

        // Add Marker
        L.marker([currentDistrict.lat, currentDistrict.lng], { icon: giwaIcon })
            .addTo(map)
            .bindPopup(`<div style="font-family: 'Noto Serif KR'; text-align: center; color: #2C2C2C;"><b>${currentDistrict.name} 틈새 스팟</b><br>고요한 휴식처</div>`)
            .openPopup();

        // Add simple zoom control to bottom right
        L.control.zoom({
            position: 'bottomright'
        }).addTo(map);

    </script>
    <style>
        @keyframes ping {

            75%,
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }
    </style>
</body>

</html>